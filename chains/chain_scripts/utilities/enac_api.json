{"openapi":"3.1.0","info":{"title":"Omnia 8 File‑API","description":"Gestione utenti, clienti e contratti Omnia 8 (archiviazione filesystem locale).","version":"2.0.0"},"paths":{"/users/{user_id}/clients/{client_id}":{"post":{"tags":["Clients"],"summary":"Crea un nuovo cliente per un utente","description":"Crea la cartella `<user_id>/<client_id>` e salva `client.json`.","operationId":"create_client_users__user_id__clients__client_id__post","parameters":[{"name":"user_id","in":"path","required":true,"schema":{"type":"string","description":"ID univoco dell’utente (cartella di primo livello).","title":"User Id"},"description":"ID univoco dell’utente (cartella di primo livello).","example":"user_123"},{"name":"client_id","in":"path","required":true,"schema":{"type":"string","description":"ID univoco del cliente (cartella dell’utente).","title":"Client Id"},"description":"ID univoco del cliente (cartella dell’utente).","example":"client_456"}],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/Client","description":"Dati anagrafici del cliente."}}}},"responses":{"201":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Client"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}},"get":{"tags":["Clients"],"summary":"Recupera i dettagli di un cliente","operationId":"get_client_users__user_id__clients__client_id__get","parameters":[{"name":"user_id","in":"path","required":true,"schema":{"type":"string","description":"ID univoco dell’utente (cartella di primo livello).","title":"User Id"},"description":"ID univoco dell’utente (cartella di primo livello)."},{"name":"client_id","in":"path","required":true,"schema":{"type":"string","description":"ID univoco del cliente (cartella dell’utente).","title":"Client Id"},"description":"ID univoco del cliente (cartella dell’utente)."}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Client"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}},"put":{"tags":["Clients"],"summary":"Aggiorna (sostituisce) i dati di un cliente","operationId":"update_client_users__user_id__clients__client_id__put","parameters":[{"name":"user_id","in":"path","required":true,"schema":{"type":"string","description":"ID univoco dell’utente (cartella di primo livello).","title":"User Id"},"description":"ID univoco dell’utente (cartella di primo livello)."},{"name":"client_id","in":"path","required":true,"schema":{"type":"string","description":"ID univoco del cliente (cartella dell’utente).","title":"Client Id"},"description":"ID univoco del cliente (cartella dell’utente)."}],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/Client","description":"Nuovi dati cliente."}}}},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Client"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}},"delete":{"tags":["Clients"],"summary":"Elimina un cliente e tutti i suoi contratti","operationId":"delete_client_users__user_id__clients__client_id__delete","parameters":[{"name":"user_id","in":"path","required":true,"schema":{"type":"string","description":"ID univoco dell’utente (cartella di primo livello).","title":"User Id"},"description":"ID univoco dell’utente (cartella di primo livello)."},{"name":"client_id","in":"path","required":true,"schema":{"type":"string","description":"ID univoco del cliente (cartella dell’utente).","title":"Client Id"},"description":"ID univoco del cliente (cartella dell’utente)."}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/DeleteResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/users/{user_id}/clients":{"get":{"tags":["Clients"],"summary":"Elenca tutti i clienti di un utente","description":"Restituisce l’elenco delle cartelle cliente presenti per l’utente.","operationId":"list_clients_users__user_id__clients_get","parameters":[{"name":"user_id","in":"path","required":true,"schema":{"type":"string","description":"ID univoco dell’utente (cartella di primo livello).","title":"User Id"},"description":"ID univoco dell’utente (cartella di primo livello)."}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"type":"array","items":{"$ref":"#/components/schemas/ClientListItem"},"title":"Response List Clients Users  User Id  Clients Get"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/users/{user_id}/clients/{client_id}/contracts":{"post":{"tags":["Contracts"],"summary":"Crea un nuovo contratto per un cliente","operationId":"create_contract_users__user_id__clients__client_id__contracts_post","parameters":[{"name":"user_id","in":"path","required":true,"schema":{"type":"string","description":"ID univoco dell’utente (cartella di primo livello).","title":"User Id"},"description":"ID univoco dell’utente (cartella di primo livello)."},{"name":"client_id","in":"path","required":true,"schema":{"type":"string","description":"ID univoco del cliente (cartella dell’utente).","title":"Client Id"},"description":"ID univoco del cliente (cartella dell’utente)."}],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/ContrattoOmnia8-Input","description":"Contratto da registrare."}}}},"responses":{"201":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/CreateContractResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}},"get":{"tags":["Contracts"],"summary":"Elenca i contratti di un cliente","operationId":"list_contracts_users__user_id__clients__client_id__contracts_get","parameters":[{"name":"user_id","in":"path","required":true,"schema":{"type":"string","description":"ID univoco dell’utente (cartella di primo livello).","title":"User Id"},"description":"ID univoco dell’utente (cartella di primo livello)."},{"name":"client_id","in":"path","required":true,"schema":{"type":"string","description":"ID univoco del cliente (cartella dell’utente).","title":"Client Id"},"description":"ID univoco del cliente (cartella dell’utente)."}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"type":"array","items":{"$ref":"#/components/schemas/ContractListItem"},"title":"Response List Contracts Users  User Id  Clients  Client Id  Contracts Get"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/users/{user_id}/clients/{client_id}/contracts/{contract_id}":{"get":{"tags":["Contracts"],"summary":"Recupera un contratto specifico","operationId":"get_contract_users__user_id__clients__client_id__contracts__contract_id__get","parameters":[{"name":"user_id","in":"path","required":true,"schema":{"type":"string","description":"ID univoco dell’utente (cartella di primo livello).","title":"User Id"},"description":"ID univoco dell’utente (cartella di primo livello)."},{"name":"client_id","in":"path","required":true,"schema":{"type":"string","description":"ID univoco del cliente (cartella dell’utente).","title":"Client Id"},"description":"ID univoco del cliente (cartella dell’utente)."},{"name":"contract_id","in":"path","required":true,"schema":{"type":"string","description":"UUID (hex) che identifica il contratto.","title":"Contract Id"},"description":"UUID (hex) che identifica il contratto."}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ContrattoOmnia8-Output"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}},"put":{"tags":["Contracts"],"summary":"Aggiorna (sostituisce) un contratto","operationId":"update_contract_users__user_id__clients__client_id__contracts__contract_id__put","parameters":[{"name":"user_id","in":"path","required":true,"schema":{"type":"string","description":"ID univoco dell’utente (cartella di primo livello).","title":"User Id"},"description":"ID univoco dell’utente (cartella di primo livello)."},{"name":"client_id","in":"path","required":true,"schema":{"type":"string","description":"ID univoco del cliente (cartella dell’utente).","title":"Client Id"},"description":"ID univoco del cliente (cartella dell’utente)."},{"name":"contract_id","in":"path","required":true,"schema":{"type":"string","description":"UUID (hex) che identifica il contratto.","title":"Contract Id"},"description":"UUID (hex) che identifica il contratto."}],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/ContrattoOmnia8-Input","description":"Nuovo contenuto completo del contratto."}}}},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ContrattoOmnia8-Output"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}},"delete":{"tags":["Contracts"],"summary":"Elimina un contratto","operationId":"delete_contract_users__user_id__clients__client_id__contracts__contract_id__delete","parameters":[{"name":"user_id","in":"path","required":true,"schema":{"type":"string","description":"ID univoco dell’utente (cartella di primo livello).","title":"User Id"},"description":"ID univoco dell’utente (cartella di primo livello)."},{"name":"client_id","in":"path","required":true,"schema":{"type":"string","description":"ID univoco del cliente (cartella dell’utente).","title":"Client Id"},"description":"ID univoco del cliente (cartella dell’utente)."},{"name":"contract_id","in":"path","required":true,"schema":{"type":"string","description":"UUID (hex) che identifica il contratto.","title":"Contract Id"},"description":"UUID (hex) che identifica il contratto."}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/DeleteResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/ping":{"get":{"summary":"Ping di salute API","description":"Ritorna *status: ok* se l’app è attiva.","operationId":"ping_ping_get","responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}}}}}},"components":{"schemas":{"Amministrativi":{"properties":{"Effetto":{"type":"string","format":"date","title":"Effetto","description":"Data di effetto del contratto.","default":"2025-07-26"},"DataEmissione":{"type":"string","format":"date","title":"Dataemissione","description":"Data di emissione della polizza.","default":"2025-07-26"},"UltRataPagata":{"type":"string","format":"date","title":"Ultratapagata","description":"Data di pagamento dell’ultima rata.","default":"2025-07-26"},"Frazionamento":{"type":"string","title":"Frazionamento","description":"Periodicità di frazionamento del premio.","default":"annuale"},"CompresoFirma":{"type":"boolean","title":"Compresofirma","description":"Flag clausola ‘compreso firma’.","default":false},"Scadenza":{"type":"string","format":"date","title":"Scadenza","description":"Data di scadenza corrente.","default":"2025-07-26"},"ScadenzaOriginaria":{"type":"string","format":"date","title":"Scadenzaoriginaria","description":"Data di scadenza originaria (pre‑proroga).","default":"2025-07-26"},"ScadenzaMora":{"anyOf":[{"type":"string","format":"date"},{"type":"null"}],"title":"Scadenzamora","description":"Data di scadenza post‑mora, se prevista."},"NumeroProposta":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Numeroproposta","description":"Numero proposta collegato alla polizza."},"ModalitaIncasso":{"type":"string","title":"Modalitaincasso","description":"Modalità di incasso del premio.","default":"-"},"CodConvenzione":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Codconvenzione","description":"Codice convenzione (se presente)."},"ScadenzaVincolo":{"anyOf":[{"type":"string","format":"date"},{"type":"null"}],"title":"Scadenzavincolo","description":"Scadenza di eventuale vincolo sul contratto."}},"type":"object","title":"Amministrativi","description":"Dati amministrativi di base."},"Client":{"properties":{"name":{"type":"string","title":"Name","description":"Ragione sociale o nome completo","default":"Cliente Placeholder"},"address":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Address","description":"Indirizzo completo (via, numero, CAP, città)"},"tax_code":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Tax Code","description":"Codice fiscale"},"vat":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Vat","description":"Partita IVA"},"phone":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Phone","description":"Telefono principale"},"email":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Email","description":"Indirizzo e‑mail"},"sector":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Sector","description":"Codice ATECO o settore di attività"},"legal_rep":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Legal Rep","description":"Legale rappresentante"},"legal_rep_tax_code":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Legal Rep Tax Code","description":"Codice fiscale del legale rappresentante"}},"type":"object","title":"Client","description":"Modello anagrafica cliente (valori di default generici)."},"ClientListItem":{"properties":{"client_id":{"type":"string","title":"Client Id","description":"Identificativo cartella cliente"}},"type":"object","required":["client_id"],"title":"ClientListItem"},"ContractListItem":{"properties":{"contract_id":{"type":"string","title":"Contract Id","description":"UUID del contratto"}},"type":"object","required":["contract_id"],"title":"ContractListItem"},"ContrattoOmnia8-Input":{"properties":{"UnitaVendita":{"$ref":"#/components/schemas/UnitaVendita"},"Amministrativi":{"$ref":"#/components/schemas/Amministrativi"},"Premi":{"$ref":"#/components/schemas/Premi-Input"},"Rinnovo":{"$ref":"#/components/schemas/Rinnovo"},"Operativita":{"$ref":"#/components/schemas/Operativita"},"RamiEl":{"$ref":"#/components/schemas/RamiEl"}},"type":"object","title":"ContrattoOmnia8","description":"Modello completo di contratto Omnia 8 con valori di default generici."},"ContrattoOmnia8-Output":{"properties":{"UnitaVendita":{"$ref":"#/components/schemas/UnitaVendita"},"Amministrativi":{"$ref":"#/components/schemas/Amministrativi"},"Premi":{"$ref":"#/components/schemas/Premi-Output"},"Rinnovo":{"$ref":"#/components/schemas/Rinnovo"},"Operativita":{"$ref":"#/components/schemas/Operativita"},"RamiEl":{"$ref":"#/components/schemas/RamiEl"}},"type":"object","title":"ContrattoOmnia8","description":"Modello completo di contratto Omnia 8 con valori di default generici."},"CreateContractResponse":{"properties":{"contract_id":{"type":"string","title":"Contract Id","description":"UUID del contratto creato"},"contratto":{"$ref":"#/components/schemas/ContrattoOmnia8-Output"}},"type":"object","required":["contract_id","contratto"],"title":"CreateContractResponse"},"DeleteResponse":{"properties":{"deleted":{"type":"boolean","title":"Deleted","description":"Operazione andata a buon fine","default":true},"id":{"type":"string","title":"Id","description":"ID eliminato (client_id o contract_id)"}},"type":"object","required":["id"],"title":"DeleteResponse"},"HTTPValidationError":{"properties":{"detail":{"items":{"$ref":"#/components/schemas/ValidationError"},"type":"array","title":"Detail"}},"type":"object","title":"HTTPValidationError"},"Operativita":{"properties":{"Regolazione":{"type":"boolean","title":"Regolazione","description":"True se la polizza prevede regolazione premio.","default":false},"ParametriRegolazione":{"$ref":"#/components/schemas/ParametriRegolazione","description":"Dettaglio parametri regolazione."}},"type":"object","title":"Operativita","description":"Opzioni operative del contratto."},"ParametriRegolazione":{"properties":{"Inizio":{"type":"string","format":"date","title":"Inizio","description":"Data inizio periodo.","default":"2025-07-26"},"Fine":{"type":"string","format":"date","title":"Fine","description":"Data fine periodo.","default":"2025-07-26"},"UltimaRegEmessa":{"anyOf":[{"type":"string","format":"date"},{"type":"null"}],"title":"Ultimaregemessa","description":"Data ultima regolazione emessa."},"GiorniInvioDati":{"anyOf":[{"type":"integer"},{"type":"null"}],"title":"Giorniinviodati","description":"Giorni per invio dati."},"GiorniPagReg":{"anyOf":[{"type":"integer"},{"type":"null"}],"title":"Giornipagreg","description":"Giorni pagamento regolazione."},"GiorniMoraRegolazione":{"anyOf":[{"type":"integer"},{"type":"null"}],"title":"Giornimoraregolazione","description":"Giorni di mora su regolazione."},"CadenzaRegolazione":{"type":"string","title":"Cadenzaregolazione","description":"Frequenza regolazione.","default":"annuale"}},"type":"object","title":"ParametriRegolazione","description":"Parametri utilizzati per la regolazione del premio."},"Premi-Input":{"properties":{"Premio":{"anyOf":[{"type":"number"},{"type":"string"}],"title":"Premio","description":"Premio annuale lordo (placeholder).","default":"0.00"},"Netto":{"anyOf":[{"type":"number"},{"type":"string"}],"title":"Netto","description":"Premio netto imponibile.","default":"0.00"},"Accessori":{"anyOf":[{"type":"number"},{"type":"string"}],"title":"Accessori","description":"Totale accessori.","default":"0.00"},"Diritti":{"anyOf":[{"type":"number"},{"type":"string"}],"title":"Diritti","description":"Diritti di emissione.","default":"0.00"},"Imposte":{"anyOf":[{"type":"number"},{"type":"string"}],"title":"Imposte","description":"Totale imposte.","default":"0.00"},"Spese":{"anyOf":[{"type":"number"},{"type":"string"}],"title":"Spese","description":"Spese amministrative.","default":"0.00"},"Fondo":{"anyOf":[{"type":"number"},{"type":"string"}],"title":"Fondo","description":"Contributo fondo garanzia.","default":"0.00"},"Sconto":{"anyOf":[{"type":"number"},{"type":"string"},{"type":"null"}],"title":"Sconto","description":"Sconto applicato al premio."}},"type":"object","title":"Premi","description":"Dettaglio economico del premio."},"Premi-Output":{"properties":{"Premio":{"type":"string","title":"Premio","description":"Premio annuale lordo (placeholder).","default":"0.00"},"Netto":{"type":"string","title":"Netto","description":"Premio netto imponibile.","default":"0.00"},"Accessori":{"type":"string","title":"Accessori","description":"Totale accessori.","default":"0.00"},"Diritti":{"type":"string","title":"Diritti","description":"Diritti di emissione.","default":"0.00"},"Imposte":{"type":"string","title":"Imposte","description":"Totale imposte.","default":"0.00"},"Spese":{"type":"string","title":"Spese","description":"Spese amministrative.","default":"0.00"},"Fondo":{"type":"string","title":"Fondo","description":"Contributo fondo garanzia.","default":"0.00"},"Sconto":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Sconto","description":"Sconto applicato al premio."}},"type":"object","title":"Premi","description":"Dettaglio economico del premio."},"RamiEl":{"properties":{"Descrizione":{"type":"string","title":"Descrizione","description":"Descrizione del ramo o estensione di garanzia.","default":"Descrizione Generica Rischio"}},"type":"object","title":"RamiEl","description":"Ramo / descrizione di rischio."},"Rinnovo":{"properties":{"Rinnovo":{"type":"string","title":"Rinnovo","description":"Tipologia di rinnovo (placeholder).","default":"da definire"},"Disdetta":{"type":"string","title":"Disdetta","description":"Dettagli disdetta.","default":"-"},"GiorniMora":{"type":"string","title":"Giornimora","description":"Giorni di mora concessi.","default":"0 giorni"},"Proroga":{"type":"string","title":"Proroga","description":"Eventuale proroga.","default":"-"}},"type":"object","title":"Rinnovo","description":"Informazioni relative al rinnovo contrattuale."},"UnitaVendita":{"properties":{"PuntoVendita":{"type":"string","title":"Puntovendita","description":"Codice o denominazione del primo punto vendita (\"-\" se non valorizzato).","default":"-"},"PuntoVendita2":{"type":"string","title":"Puntovendita2","description":"Codice o denominazione del secondo punto vendita (\"-\" se non presente).","default":"-"},"Account":{"type":"string","title":"Account","description":"Referente commerciale interno assegnato al contratto (valore generico).","default":"Account Placeholder"},"Intermediario":{"type":"string","title":"Intermediario","description":"Compagnia o broker che ha intermediato la polizza (valore generico).","default":"Intermediario Placeholder"}},"type":"object","title":"UnitaVendita","description":"Informazioni sull’unità di vendita che ha originato il contratto."},"ValidationError":{"properties":{"loc":{"items":{"anyOf":[{"type":"string"},{"type":"integer"}]},"type":"array","title":"Location"},"msg":{"type":"string","title":"Message"},"type":{"type":"string","title":"Error Type"}},"type":"object","required":["loc","msg","type"],"title":"ValidationError"}}}}